# Ruoshi Sun
# 2025-04-17 py3.12
easyblock = 'Conda'

name = 'jupyterlab'
version = 'test'
versionsuffix = '-py3.12'
hidden = True

homepage = 'https://jupyter.org/'
description = """JupyterLab is the latest web-based interactive development environment for notebooks, code, and data. Its flexible interface allows users to configure and arrange workflows in data science, scientific computing, computational journalism, and machine learning. A modular design invites extensions to expand and enrich functionality.
"""

toolchain = SYSTEM

builddependencies = [('miniforge', '24.11.3', versionsuffix)]

channels = ['conda-forge']
requirements = ' '.join([
    'python=3.12',
    '%(name)s=4.4.6', #%(version)s',
    'cython=3.1.3',
    'glib=2.84.3',
    'h5py=3.14.0',
    'ipywidgets=8.1.7',
#    spinning wheel for subfolders https://github.com/jupyterlab/jupyter-collaboration/issues/234
#    'jupyter-collaboration=4.1.0',
    'matplotlib=3.10.5',
    'nodejs=24.4.1',
    'notebook=7.4.5',
    'numba=0.61.2',
    'numpy=2.2.6',
    'pandas=2.3.2',
    'pandoc=3.7.0.2',
    'pillow=11.3.0',
    'scikit-image=0.25.2',
    'scikit-learn=1.7.1',
    'scipy=1.16.1',
    'seaborn=0.13.2',
    'tqdm=4.67.1',
    'zeromq=4.3.5',
])

postinstallcmds = [
    '%(installdir)s/bin/pip install --no-cache-dir jupyter-resource-usage==1.2.0 jupyterlab-nvdashboard==0.13.0 plotly==6.3.0 dash==3.2.0 voila==0.5.11',
    'export PATH=%(installdir)s/bin:$PATH LD_LIBRARY_PATH=%(installdir)s/lib:$LD_LIBRARY_PATH && jupyter lab build',
    'chmod -R go-w %(installdir)s',
]

modextravars = {
    'PIP_DISABLE_PIP_VERSION_CHECK': '1',
}

moduleclass = 'tools'
